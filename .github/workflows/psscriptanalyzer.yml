name: Run PSScriptAnalyzer

on: [push, pull_request]

jobs:
  lint:
    name: Run PSScriptAnalyzer
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.x'  # Specify the .NET Core version

    - name: Install PSScriptAnalyzer
      run: Install-Module -Name PSScriptAnalyzer -Force -Scope CurrentUser
      shell: pwsh

    - name: Run PSScriptAnalyzer
      run: Invoke-ScriptAnalyzer -Path ./ -Recurse -Severity Error -EnableExit
      shell: pwsh
