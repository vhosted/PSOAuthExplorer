name: Run PSScriptAnalyzer

on: [push, pull_request]

jobs:
  lint:
    name: Run PSScriptAnalyzer
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up PowerShell
      uses: actions/setup-powershell@v2

    - name: Install PSScriptAnalyzer
      run: Install-Module -Name PSScriptAnalyzer -Force -Scope CurrentUser
      shell: pwsh

    - name: Run PSScriptAnalyzer
      run: Invoke-ScriptAnalyzer -Path ./ -Recurse -Severity Error -EnableExit
      shell: pwsh
